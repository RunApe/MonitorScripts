## ChangesAPI

With the ChangesAPI you can gain useful insights into changed data and make use of the markings that the selection filters produce on changed page elements.

The content versions that contain the changes are saved on our servers in the Change_ContentID.html file for you to find them using the methods described in the table below.

| **Method**                                        | **Path**                                                     | **Description**                                              |
| ------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| [Files pages](https://runape.com/Support/Help?page=files) :blue_book: | ![img](https://github.com/RunApe/MediaFiles/raw/master/Git/changesapi_filepath.png) | Right click on the file to open the menu<br>![img](https://github.com/RunApe/MediaFiles/raw/master/Git/changesapi_filepath_contextmenu.png) |
| [API](https://runape.com/Support/API)             | Webscape/GetContent method                                   | Query for the URL path of the Change_ContentID.html <br>by sending the MonitorID and SelectionID. |

The changes in a selection are marked with special CSS classes as described in the table below.

The `changesapi` is a simple helper library that uses these markings and lets you query for the changed elements from your monitor scripts.

The `changesapi` fetches your Change_ContentID.html and loads it into a temporary element from where it returns you the changes using below classes. The `changesapi` must run in a monitor script or in a context of a webpage.

| Filter                                                       | Class            | Description                                                  |
| :----------------------------------------------------------- | ---------------- | ------------------------------------------------------------ |
| All filters                                                  | `mon-cut`        | Applied to elements that have changed (group or single).     |
| No filters                                                   | `mon_ignored`    | Applied to elements that are excluded by selection's filters. See [Smart Ignores](https://runape.com/Support/Help?page=smart_ignores) :blue_book:. |
| [Watch any changes](https://runape.com/Support/Help?page=watch_any_changes) :blue_book: | `mon-del`        | Removed element (group change)                               |
|                                                              | `mon-ins`        | New element (group change)                                   |
|                                                              | `mon-delins`     | Element has partial changes                                  |
|                                                              | `mon-delins del` | Removed element (single change)                              |
|                                                              | `mon-delins ins` | New element (single change)                                  |
| [Watch new text](https://runape.com/Support/Help?page=watch_new_text) :blue_book: | `mon-mark-2`     | Element with new text only                                   |
| [Watch text changes](https://runape.com/Support/Help?page=watch_text_changes) :blue_book: | `mon-mark-3`     | Element with changed text.<br> Changes are further contained inside of `del` and `ins` elements. |
| [Watch number changes](https://runape.com/Support/Help?page=watch_number_changes) :blue_book: | `mon-mark-4`     | Element with changed numbers.<br> Changes are further contained inside of `del` and `ins` elements. |


## Loading

#### Webpage include 

```HTML
<script src="https://runape.com/scripts/releasebin/changesapi.js"></script>
```

#### Script page injection

```javascript
//CasperJS
this.page.includeJs("https://runape.com/scripts/releasebin/changesapi.js"); //via URL
this.page.injectScript("./Scripts/node_modules/runape-changes/changesapi.js");  //via fs from your folder

//Puppeteer
const changesapiPath = require.resolve('/Scripts/node_modules/runape-changes');
await page.addScriptTag({ path: changesapiPath });
```

#### Require module

```javascript 
//CasperJS or Puppeteer
var ChangesApi = require("runape-changes");
```
## Functions

The ChangesApi implements following functions: `, , ` and ` `. See the [ChangesApi code samples](https://github.com/RunApe/MonitorScripts/tree/master/samples/changesapi) that show how they are used in different environments.
***

## Tips and Tricks

Since a monitor script runs before the filters you can preprocess the monitored page with a monitor script and change the look of the page in any way you like. Any looks you have applied are saved in the content versions and sent in emails.

If you need to mark an element as a change, apply the class `mon-cut` to those elements. Elements classed like this are considered as a change and are included in versions, screenshots and emails. 

If you need to ignore elements, apply the class `mon-ignore` to those elements.

In addition, you can apply any of the classes from the table above.



