

  **Modules**
==================================================

The [Monitor scripts](https://runape.com/Support/Help?page=monitor_script) :blue_book: allow you to use custom or third-party NodeJS modules with Puppeteer scripts. Custom modules in CasperJS are disabled but many useful modules are provided, see [Restrictions](https://github.com/RunApe/MonitorScripts/tree/master/node_modules#casperjs) below.


## Pre-installed RunApe modules

The modules listed below come pre-installed in your `/Scripts/node_modules` folder. Their versions are not updated in your folders but the latest versions are always found here on GitHub.

* The `comapi` provides simple tools for your applications to authenticate to and interact with RunApe over the WebAPI. 
* The `changesapi` provides simple tools to retrieve content version changes produced by the selection filters.
* The `fstore` encapsulates the built-in `fs` module and can be used to store objects to an encrypted file within your private folders at RunApe.

## Modules installation and require

1. Install the necessary [modules](https://www.npmjs.com/browse/depended) on your computer *(npm i moduleName)*
2. Create a .zip file with the `node_modules` contents
3. Extract ![img](https://github.com/RunApe/MediaFiles/raw/master/Git/unzip_file.png) the .zip file to the `/Scripts/node_modules/` folder using the RunApe [Files webpage](https://runape.com/Support/Help?page=files).
4. Require
   ```javascript
      const MyModule = require("/Scripts/node_modules/my-module")
   ```

## Module and functional restrictions

Some native modules are not allowed and have been disabled in the system. These modules include those that: query and set system properties, create or kill processes, create socket listeners (web servers), etc. The `fs` module has only access to your [private folders](https://runape.com/Support/Help?page=files).

### CasperJS
Following global properties among others are available to your CasperJS script: `test` (see [Scripting basics](https://github.com/RunApe/MonitorScripts/blob/master/README.md#scripting-basics))`, console, require, casper, phantom, XMLHttpRequest, utils, sessionStorage, localStorage, indexedDB, etc.`

Following modules are available for require:

* RunApe modules *(always latest)*: [comapi](https://github.com/RunApe/MonitorScripts/tree/master/lib#comapijs),
[changesapi](https://github.com/RunApe/MonitorScripts/tree/master/lib#changejs),
[fstore](https://www.github.com/RunApe/MonitorScripts#fstore) <br>
* JavaScript extensions and tools: 
[async](https://www.npmjs.com/package/async) v2.6.3,
[bluebird](https://www.npmjs.com/package/bluebird) v3.7.2,
[q](https://www.npmjs.com/package/q) v1.5.1, [linq](https://www.npmjs.com/package/linq) v3.2.3, [lodash](https://www.npmjs.com/package/lodash) v4.17.20, [underscore](https://www.npmjs.com/package/underscore) v1.12.0
* Network: [axios](https://www.npmjs.com/package/axios) v0.21.0 *(always use IPs instead of domain names with axios)*<br>
* Parsers and converters: 
[data2xml](https://www.npmjs.com/package/data2xml) v1.3.4, 
[easyxml](https://www.npmjs.com/package/easyxml) v2.0.1,
[jsontoxml](https://www.npmjs.com/package/jsontoxml) v1.0.1, 
[jstoxml](https://www.npmjs.com/package/jstoxml) v2.0.2, 
[xmltojson](https://www.npmjs.com/package/xmltojson) v1.3.5, 
[papaparse](https://www.npmjs.com/package/papaparse) v5.3.0, 
[pretty-data2](https://www.npmjs.com/package/pretty-data2) v0.40.1, 
* Utils: 
[deep-diff](https://www.npmjs.com/package/deep-diff) v1.0.2, 
[mime](https://www.npmjs.com/package/mime) v2.4.6, 
[moment](https://www.npmjs.com/package/moment) v2.29.1, 
[url](https://www.npmjs.com/package/url) v0.11.0, 
[util](https://www.npmjs.com/package/util) v0.10.4, 
[validator](https://www.npmjs.com/package/validator) v13.1.17

***Note:** If you need a different module, send us an email at support@runape.com.*

### Puppeteer/NodeJS
Only the following global properties are accessible to your Puppeteer script:
* `test` (see [Scripting basics](https://github.com/RunApe/MonitorScripts/blob/master/README.md#scripting-basics))`, console, require, getPage(), setInterval, setTimeout, clearInterval, clearTimeout` and `XMLHttpRequest`. The `getPage()` opens Chrome and returns a page. Multiple calls return the same page.

The following Puppeteer properties are not available: 
* `Browser, BrowserContext, FileChooser` and `CDPSession`, 

The following NodeJS Built-in modules can be required but are disabled. The entry "NOOP_functionName" appears in the script execution log when any of the disabled functions are executed.
* `child_process, cluster, dgram, dns, domain, inspector, module, os, process, punycode, repl, sys, tls, tty, v8, vm` and `worker_threads`

***Note:** If you think a NOOP_X does no harm and should be enabled, send us an email at support@runape.com.*
